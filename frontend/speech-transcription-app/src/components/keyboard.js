import React from 'react';
import 'react-simple-keyboard/build/css/index.css';
import Keyboard from 'react-simple-keyboard';

const VirtualKeyboard = ({ onChange, onBackspace, onSpace, onEnter }) => {
  
  const onKeyPress = (button) => {
    let textarea = document.activeElement; // Get the currently focused element
  
    if (!textarea || textarea.tagName !== "TEXTAREA") {
      // If there is no currently focused textarea, find the nearest one
      const textareas = document.getElementsByTagName("textarea");
      textarea = textareas[0];
    }
  
    switch (button) {
      case "{bksp}":
        onBackspace();
        break;
      case "{space}":
        onSpace();
        break;
      case "{enter}":
        onEnter();
        break;
      default:
        const { selectionStart, selectionEnd } = textarea; // Get cursor position
        const value = textarea.value;
        const newValue = value.substring(0, selectionStart) + button + value.substring(selectionEnd);
        textarea.value = newValue; // Update element value
        textarea.selectionStart = textarea.selectionEnd = selectionStart + 1; // Move cursor forward
        onChange(newValue);
        break;
    }
  };
  
  
  

  return <Keyboard onKeyPress={onKeyPress} 
  layout={{
    'default': [
      "\u0C4A 1 2 3 4 5 6 7 8 9 0 - \u0C43 {bksp}",
      "{tab} \u0C4C \u0C48 \u0C3E \u0C40 \u0C42 \u0C2C \u0C39 \u0C17 \u0C26 \u0C1C \u0C21 {//} {//}",
      "{lock} \u0C4B \u0C47 \u0C4D \u0C3F \u0C41 \u0C2A \u0C30 \u0C15 \u0C24 \u0C1A \u0C1F {enter}",
      "{shift} {//} \u0C46 \u0C02 \u0C2E \u0C28 \u0C35 \u0C32 \u0C38 , . \u0C2F {shift}",
      ".com @ {space}"
    ],
    'shift': [
      "\u0C12 {//} {//} \u0C4D\u0C30 {//} \u0C1C\u0C4D\u0C1E \u0C24\u0C4D\u0C30 \u0C15\u0C4D\u0C37 \u0C36\u0C4D\u0C30 ( ) \u0C03 \u0C0B {bksp}",
      "{tab} \u0C14 \u0C10 \u0C06 \u0C08 \u0C0A \u0C2D \u0C19 \u0C18 \u0C27 \u0C1D \u0C22 \u0C1E {//}",
      "{lock} \u0C13 \u0C0F \u0C05 \u0C07 \u0C09 \u0C2B \u0C31 \u0C16 \u0C25 \u0C1B \u0C20 {enter}",
      "{shift} {//} \u0C0E \u0C01 \u0C23 \u0C28 {//} \u0C33 \u0C36 \u0C37 {//} {//} {shift}",
      ".com @ {space}"
    ]
  }}
  />;
};


export default VirtualKeyboard;